---
title: "STAT 600 - HW 2"
author: "Kevin Korsurat"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(Rcpp)
library(RcppArmadillo)
library(ggplot2)
library(latex2exp)

# path <- "/Users/kevin-imac/Desktop/Github - Repo/HW2Optim/src/"
path <- "/Users/kevinkvp/Desktop/Github Repo/HW2Optim/src/"
sourceCpp(paste0(path, "main.cpp"))
```

## Question 1

### (a)

First, consider the likelihood and the log-likelihood function.

$$\begin{aligned}
L\left(\theta\right) &= \prod_{i=1}^{n}\frac{1}{\pi\left(1 + \left(x_{i} - \theta\right)^{2}\right)} \\
l\left(\theta\right) &= \log\left(L\left(\theta\right)\right) \\
&= \log\left(\prod_{i=1}^{n}\frac{1}{\pi\left(1 + \left(x_{i} - \theta\right)^{2}\right)}\right) \\
&= \sum_{i=1}^{n}\log\left(\frac{1}{\pi\left(1 + \left(x_{i} - \theta\right)^{2}\right)}\right) \\
&= -\sum_{i=1}^{n}\log\left(\pi\left(1 + \left(x_{i} - \theta\right)^{2}\right)\right) \\
&= - n\log\left(\pi \right) - \sum_{i=1}^{n}\log\left(1 + \left(x_{i} - \theta\right)^{2}\right)
\end{aligned}$$

Then, consider the derivative of the log-likelihood, $l'\left(\theta\right)$.

$$\begin{aligned}
l'\left(\theta\right) &= \frac{d}{d\theta}l\left(\theta\right) \\
&= -\sum_{i=1}^{n}\frac{1}{1 + \left(x_{i} - \theta\right)^{2}} \left[\frac{d}{d\theta}\left(x_{i} - \theta\right)^{2}\right] \\
&= 2\sum_{i=1}^{n}\frac{x_{i} - \theta}{1 + \left(x_{i} - \theta\right)^{2}}
\end{aligned}$$

```{r, fig.cap = "The plot of the derivative of the log-likelihood on the original dataset."}
dat <- c(-8.86, -6.82, -4.03, -2.84, 0.14, 0.19, 0.24, 0.27, 0.49, 0.62, 0.76, 1.09,
         1.18, 1.32, 1.36, 1.58, 1.58, 1.78, 2.13, 2.15, 2.36, 4.05, 4.11, 4.12, 
         6.83)
rangeTheta <- seq(-10, 10, 0.01)
data.frame(theta = rangeTheta, dll = sapply(rangeTheta, dloglik, x = dat)) %>%
  ggplot(aes(x = theta, y = dll)) +
  geom_line() +
  theme_bw() +
  labs(x = TeX("\\theta"), y = TeX("l'(\\theta)"), 
       title = "The plot of the derivative of the log-likelihood based on 25 daat points")
```

### (b)

This is the second derivation for the log-likelihood function.

$$\begin{aligned}
l''\left(\theta\right) &= \frac{d}{d\theta}l'\left(\theta\right) \\
&= \frac{d}{d\theta} 2\sum_{i=1}^{n}\frac{x_{i} - \theta}{1 + \left(x_{i} - \theta\right)^{2}} \\
&= 2 \sum_{i=1}^{n} \frac{d}{d\theta} \frac{x_{i} - \theta}{1 + \left(x_{i} - \theta\right)^{2}} \\
&= 2 \sum_{i=1}^{n} \frac{-1 + \left(x_{i} - \theta\right)^{2}}{\left(1 + \left(x_{i} - \theta\right)^{2}\right)^{2}}
\end{aligned}$$


### (d)

For the convergence criteria used in this problem, I decided to employ the absolute convergence criterion, as the $x^{(t)}$ might be close to 0 in some iterations, as indicated by the plot shown in part (a). Additionally, the value of x is neither too tiny nor too huge compared to $\epsilon$.

